<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reetoul Image Format Conversion Tool</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://cdn.lordicon.com/bhenfmcm.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback" async defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <style>
   @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

:root {
    --primary-color: #6366f1;
    --secondary-color: #a855f7;
    --background-color: #0f172a;
    --text-color: #e2e8f0;
}

* {
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    background-color: var(--background-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    font-size: 16px;
    line-height: 1.5;
}

.gradient-bg {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
}

.hover-scale {
    transition: transform 0.3s ease-in-out;
}

.hover-scale:hover {
    transform: scale(1.05);
}

.loader {
    border-top-color: var(--secondary-color);
    animation: spinner 1.5s linear infinite;
}

@keyframes spinner {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.blob {
    border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
    background: linear-gradient(45deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    filter: blur(40px);
}

.image-preview-container {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.overlay {
    background-color: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
}

.scrollbar-hide {
    scrollbar-width: none;
    -ms-overflow-style: none;
}

.scrollbar-hide::-webkit-scrollbar {
    display: none;
}

.drag-drop-area {
    border: 2px dashed var(--secondary-color);
    transition: all 0.3s ease;
}

.drag-drop-area.dragover {
    background-color: rgba(168, 85, 247, 0.1);
    border-color: var(--primary-color);
}

.header, .footer {
    background: rgba(15, 23, 42, 0.8);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
}

.footer a {
    transition: color 0.3s ease;
}

.footer a:hover {
    color: var(--secondary-color);
}

.benefit-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.benefit-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.typed-cursor {
    color: var(--secondary-color);
}

.faq-item {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.faq-item:hover {
    background: rgba(255, 255, 255, 0.1);
}

.faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease-out;
}

.faq-item.active .faq-answer {
    max-height: 300px;
    transition: max-height 0.5s ease-in;
}

.faq-icon {
    transition: transform 0.3s ease;
}

.faq-item.active .faq-icon {
    transform: rotate(180deg);
}

.action-button {
    background-color: #6b46c1;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.action-button:hover {
    background-color: #7c3aed;
}

.progress-bar {
    width: 100%;
    background-color: #4a5568;
    border-radius: 9999px;
    overflow: hidden;
}

.progress {
    width: 0;
    height: 6px;
    background-color: var(--secondary-color);
    transition: width 0.3s ease;
}

.format-dropdown {
    position: relative;
    display: inline-block;
}

.format-dropdown-content {
    display: none;
    position: absolute;
    background-color: #1f2937;
    min-width: 250px;
    box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
    z-index: 1;
    border-radius: 8px;
    padding: 10px;
}

.format-dropdown:hover .format-dropdown-content {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
}

.format-option {
    padding: 12px;
    text-decoration: none;
    display: block;
    color: var(--text-color);
    transition: all 0.3s ease;
    border-radius: 6px;
}

.format-option:hover {
    background-color: #374151;
    color: var(--secondary-color);
}

.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

.loading-spinner {
    border: 4px solid #f3f3f3;
    border-top: 4px solid var(--secondary-color);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
}

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
}

/* Responsive adjustments */
@media screen and (max-width: 1024px) {
    body {
        font-size: 14px;
    }
    
    .grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
}

@media screen and (max-width: 768px) {
    .format-dropdown-content {
        min-width: 200px;
    }
    
    .action-button {
        padding: 10px 20px;
        font-size: 14px;
    }
}

@media screen and (max-width: 480px) {
    body {
        font-size: 12px;
    }
    
    .grid {
        grid-template-columns: 1fr;
    }
    
    .format-dropdown-content {
        min-width: 150px;
    }
    
    .action-button {
        padding: 8px 16px;
        font-size: 12px;
    }
}
    .verification-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    backdrop-filter: blur(5px);
}

.verification-container {
    background: #1f2937;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    text-align: center;
    max-width: 400px;
    width: 90%;
}

.verification-title {
    color: white;
    font-size: 1.5rem;
    margin-bottom: 1rem;
}

.verification-description {
    color: #9ca3af;
    margin-bottom: 1.5rem;
}

.verification-widget-container {
    display: flex;
    justify-content: center;
    margin-top: 1rem;
}
</style>

</head>
<body class="bg-gray-900 text-white min-h-screen p-4">
    <header class="py-4 px-6">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <a href="/" class="flex items-center">
                <img src="Denmara__1_-removebg-preview.png" alt="Denmara Logo" class="w-12 h-12 sm:w-16 sm:h-16">
                <span class="ml-2 text-xl sm:text-2xl font-bold">Reetoul</span>
            </a>
            <a href="/login.html" id="loginText" class="hover:text-purple-400 transition duration-300">Login</a>
        </div>
    </header>

    <main class="flex-grow mt-20">
        <div class="bg-gray-800 rounded-3xl shadow-2xl w-full max-w-4xl mx-auto my-8">
            <div class="bg-gradient-to-r from-purple-500 to-indigo-500 p-6 sm:p-8 rounded-t-3xl">
                <h1 class="text-3xl sm:text-4xl font-bold text-center">Image Format Conversion Tool</h1>
                <p class="text-gray-200 text-center mt-2">Convert your images to various formats with ease</p>
            </div>

            <div class="p-6 sm:p-8">
                <div id="dragDropArea" class="mb-8 flex flex-col items-center justify-center h-40 border-2 border-dashed border-purple-500 rounded-lg cursor-pointer">
                    <input type="file" id="fileInput" accept="image/*" class="hidden" multiple>
                    <lord-icon
                        src="https://cdn.lordicon.com/nxooksci.json"
                        trigger="hover"
                        colors="primary:#a855f7,secondary:#6366f1"
                        style="width:64px;height:64px;">
                    </lord-icon>
                    <p class="mt-2 text-sm text-gray-400 text-center">Choose files or<br>Drag and Drop here!</p>
                </div>

                <div id="imagePreview" class="mb-8 hidden">
                    <div id="previewContainer" class="flex flex-wrap justify-center gap-4"></div>
                </div>

                <div id="conversionOptions" class="mb-8 hidden">
                    <label class="block text-sm font-medium text-gray-300 mb-2">Select output format:</label>
                    <div class="relative">
                        <button id="formatDropdownBtn" class="bg-gray-700 text-white p-2 rounded-lg w-full text-left flex justify-between items-center">
                            <span id="selectedFormat">PNG</span>
                            <i class="fas fa-chevron-down ml-2"></i>
                        </button>
                        <div id="formatDropdownContent" class="hidden absolute z-10 mt-1 w-full bg-gray-700 rounded-md shadow-lg">
                            <div class="p-2 grid grid-cols-2 gap-2">
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="png">PNG</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="jpeg">JPEG</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="webp">WebP</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="gif">GIF</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="bmp">BMP</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="tiff">TIFF</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="ico">ICO</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="svg">SVG</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="pdf">PDF</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="eps">EPS</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="heic">HEIC</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="jp2">JP2</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="psd">PSD</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="raw">RAW</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="tga">TGA</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="hdr">HDR</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="exr">EXR</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="dds">DDS</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="xcf">XCF</div>
                                <div class="format-option bg-gray-600 hover:bg-gray-500 p-2 rounded cursor-pointer" data-format="jxr">JXR</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-center space-x-4">
                    <button id="convertBtn" class="action-button flex items-center bg-purple-500 text-white p-2 rounded-lg">
                        <i class="fas fa-exchange-alt mr-2"></i>
                        <span>Convert Images</span>
                    </button>
                    <div id="verificationOverlay" class="verification-overlay">
    <div class="verification-container">
        <div class="text-center">
            <h2 class="verification-title">Please Verify to Download</h2>
            <p class="verification-description">Complete the verification below to continue your download</p>
            <div class="verification-widget-container">
                <div class="cf-turnstile" 
                    data-sitekey="0x4AAAAAAAUhJHCEYNsicK5E" 
                    data-callback="turnstileCallback" 
                    data-theme="dark">
                </div>
            </div>
        </div>
    </div>
</div>
                    <button id="downloadBtn" class="action-button flex items-center bg-green-500 text-white p-2 rounded-lg hidden">
                        <i class="fas fa-download mr-2"></i>
                        <span>Download All</span>
                    </button>
                </div>
            </div>
        </div>
        </main>
<div class="max-w-4xl mx-auto mt-16 sm:mt-20 mb-16">
        <h2 class="text-3xl font-bold text-center mb-12 gradient-bg text-white" data-aos="fade-up">Benefits of Reetoul Image Format Conversion Tool</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="benefit-card p-6 rounded-xl" data-aos="fade-up" data-aos-delay="100">
                <lord-icon
                    src="https://cdn.lordicon.com/iifryyua.json"
                    trigger="hover"
                    colors="primary:#a855f7,secondary:#6366f1"
                    style="width:64px;height:64px;">
                </lord-icon>
                <h3 class="text-xl font-semibold mt-4 mb-2">Multi-Format Support</h3>
                <p class="text-gray-300 h-20"><span class="typed-text" data-typed='["Convert images to and from various formats including JPEG, PNG, WebP, and more."]'></span></p>
            </div>
            <div class="benefit-card p-6 rounded-xl" data-aos="fade-up" data-aos-delay="200">
                <lord-icon
                    src="https://cdn.lordicon.com/eszyyflr.json"
                    trigger="hover"
                    colors="primary:#a855f7,secondary:#6366f1"
                    style="width:64px;height:64px;">
                </lord-icon>
                <h3 class="text-xl font-semibold mt-4 mb-2">Batch Conversion</h3>
                <p class="text-gray-300 h-20"><span class="typed-text" data-typed='["Convert multiple images at once, saving time and effort."]'></span></p>
            </div>
            <div class="benefit-card p-6 rounded-xl" data-aos="fade-up" data-aos-delay="300">
                <lord-icon
                    src="https://cdn.lordicon.com/nocovwne.json"
                    trigger="hover"
                    colors="primary:#a855f7,secondary:#6366f1"
                    style="width:64px;height:64px;">
                </lord-icon>
                <h3 class="text-xl font-semibold mt-4 mb-2">Quality Control</h3>
                <p class="text-gray-300 h-20"><span class="typed-text" data-typed='["Adjust compression and quality settings to balance file size and image quality."]'></span></p>
            </div>
        </div>
    </div>
    
    <div class="max-w-4xl mx-auto mt-20 mb-16">
        <h2 class="text-3xl font-bold text-center mb-12 gradient-bg text-white" data-aos="fade-up">Frequently Asked Questions</h2>
        <div class="space-y-4" data-aos="fade-up" data-aos-delay="200">
            <div class="faq-item rounded-lg p-4 cursor-pointer">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-semibold">What image formats are supported?</h3>
                    <svg class="faq-icon w-6 h-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
                <div class="faq-answer mt-2 text-gray-300">
                    <p>Our Image Format Conversion Tool supports a wide range of formats, including:
                    - JPEG (.jpg, .jpeg)
                    - PNG (.png)
                    - WebP (.webp)
                    - GIF (.gif)
                    - TIFF (.tiff, .tif)
                    - BMP (.bmp)
                    - HEIC (.heic) (conversion from HEIC only)
                    You can convert between any of these formats, except for HEIC, which is supported for input only.</p>
                </div>
            </div>
            <div class="faq-item rounded-lg p-4 cursor-pointer">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-semibold">How does batch conversion work?</h3>
                    <svg class="faq-icon w-6 h-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
                <div class="faq-answer mt-2 text-gray-300">
                    <p>Batch conversion allows you to convert multiple images at once:
                    1. Click the "Add Files" button or drag and drop multiple images.
                    2. Select the desired output format for all images.
                    3. Adjust any settings (e.g., quality, compression) as needed.
                    4. Click "Convert All" to process all images.
                    5. Once complete, you can download all converted images as a zip file.</p>
                </div>
            </div>
            <div class="faq-item rounded-lg p-4 cursor-pointer">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-semibold">Is there a limit to file size or number of images?</h3>
                    <svg class="faq-icon w-6 h-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
                <div class="faq-answer mt-2 text-gray-300">
                    <p>To ensure optimal performance:
                    - Maximum file size: 50 MB per image
                    - Maximum batch size: 100 images or 500 MB total, whichever is reached first
                    - For larger batches, you can process images in multiple sessions
                    If you need to convert larger files or batches, please contact our support team for assistance.</p>
                </div>
            </div>
            <div class="faq-item rounded-lg p-4 cursor-pointer">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-semibold">How is image quality preserved during conversion?</h3>
                    <svg class="faq-icon w-6 h-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
                <div class="faq-answer mt-2 text-gray-300">
                    <p>We use advanced algorithms to maintain image quality:
                    - Lossless conversion when possible (e.g., PNG to WebP)
                    - Adjustable quality settings for lossy formats (e.g., JPEG)
                    - Color profile preservation
                    - Option to maintain original image dimensions
                    - Preview feature to compare before and after conversion
                    Remember, converting from a lossy format (like JPEG) to a lossless format (like PNG) won't restore previously lost quality.</p>
                </div>
            </div>
            <div class="faq-item rounded-lg p-4 cursor-pointer">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-semibold">Is my data safe when using this tool?</h3>
                    <svg class="faq-icon w-6 h-6 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </div>
                <div class="faq-answer mt-2 text-gray-300">
                    <p>We take your privacy and data security seriously:
                    - All conversions are processed on our secure servers
                    - Files are automatically deleted from our servers after conversion
                    - We use HTTPS encryption for all data transfers
                    - We never access or view the content of your images
                    - No registration is required to use the tool
                    For more information, please review our Privacy Policy.</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer mt-16 py-6 px-6">
        <div class="max-w-6xl mx-auto flex flex-col items-center">
            <div class="mb-4">
                <a href="/terms.html" class="text-gray-300 hover:text-white mx-2">Terms and Conditions</a>
                <a href="/privacy.html" class="text-gray-300 hover:text-white mx-2">Privacy Policy</a>
            </div>
            <div class="text-gray-400 text-sm">
                &copy;2024 reetoul.com
            </div>
        </div>
    </footer>

    <button id="scrollTopBtn" class="fixed bottom-4 right-4 bg-purple-500 text-white p-2 rounded-full shadow-lg transition-opacity duration-300 opacity-0 invisible">
        <i class="fas fa-arrow-up"></i>
    </button>

    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
    // DOM Elements
    const dragDropArea = document.getElementById('dragDropArea');
    const fileInput = document.getElementById('fileInput');
    const imagePreview = document.getElementById('imagePreview');
    const previewContainer = document.getElementById('previewContainer');
    const conversionOptions = document.getElementById('conversionOptions');
    const convertBtn = document.getElementById('convertBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const selectedFormatDisplay = document.getElementById('selectedFormat');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const scrollTopBtn = document.getElementById('scrollTopBtn');
    const formatDropdownBtn = document.getElementById('formatDropdownBtn');
    const formatDropdownContent = document.getElementById('formatDropdownContent');

    // State management
    let selectedFiles = [];
    let selectedFormat = 'png';
    let isVerified = false;
    let turnstileWidget = null;

    // Initialize UI states
    loadingOverlay.style.display = 'none';
    downloadBtn.classList.add('hidden');

    // User avatar handling
    const userAvatar = localStorage.getItem('userAvatar');
    const loginText = document.getElementById('loginText');
    if (userAvatar && loginText) {
        loginText.innerHTML = `<img src="${userAvatar}" alt="User Avatar" class="w-8 h-8 rounded-full">`;
    }

    // Turnstile Functions
    function initializeTurnstile() {
        if (turnstileWidget) {
            turnstile.remove(turnstileWidget);
        }

        turnstileWidget = turnstile.render('#turnstile-container', {
            sitekey: '0x4AAAAAAAUhJHCEYNsicK5E',
            callback: turnstileCallback,
            theme: 'dark',
            'expired-callback': () => {
                isVerified = false;
                showError("Verification expired. Please verify again.");
            },
            'error-callback': () => {
                isVerified = false;
                showError("Verification failed. Please try again.");
            }
        });
    }

    function showVerificationOverlay() {
        const verificationOverlay = document.getElementById('verificationOverlay');
        if (!verificationOverlay) {
            console.error('Verification overlay element not found');
            return;
        }

        verificationOverlay.style.display = 'flex';
        initializeTurnstile();
    }

    async function turnstileCallback(token) {
        try {
            const response = await fetch('/verify-turnstile', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ token })
            });

            const data = await response.json();

            if (data.success) {
                isVerified = true;
                const verificationOverlay = document.getElementById('verificationOverlay');
                verificationOverlay.style.display = 'none';
                proceedWithDownload();
            } else {
                throw new Error('Verification failed');
            }
        } catch (error) {
            console.error('Turnstile verification error:', error);
            showError("Verification failed. Please try again.");
            isVerified = false;
            initializeTurnstile();
        }
    }

    // Drag and Drop Functions
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dragDropArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    dragDropArea.addEventListener('dragenter', highlight, false);
    dragDropArea.addEventListener('dragover', highlight, false);
    dragDropArea.addEventListener('dragleave', unhighlight, false);
    dragDropArea.addEventListener('drop', handleDrop, false);

    function highlight(e) {
        preventDefaults(e);
        dragDropArea.classList.add('dragover');
    }

    function unhighlight(e) {
        preventDefaults(e);
        dragDropArea.classList.remove('dragover');
    }

    function handleDrop(e) {
        preventDefaults(e);
        unhighlight(e);
        const dt = e.dataTransfer;
        const files = dt.files;
        handleFiles(files);
    }

    // File Handling Functions
    dragDropArea.addEventListener('click', () => {
        fileInput.click();
    });

    fileInput.addEventListener('change', function (e) {
        handleFiles(this.files);
    });

    function handleFiles(files) {
        selectedFiles = Array.from(files).filter(file => file.type.startsWith('image/'));
        if (selectedFiles.length > 0) {
            displayPreviews(selectedFiles);
        } else {
            showError("Please select at least one image file.");
        }
    }

    function displayPreviews(files) {
        previewContainer.innerHTML = '';
        files.forEach((file, index) => {
            const reader = new FileReader();
            reader.onload = function (e) {
                const previewWrapper = document.createElement('div');
                previewWrapper.className = 'relative';
                const previewImg = document.createElement('img');
                previewImg.src = e.target.result;
                previewImg.className = 'w-24 h-24 object-cover rounded-lg';
                previewWrapper.appendChild(previewImg);

                const removeBtn = document.createElement('button');
                removeBtn.innerHTML = '&times;';
                removeBtn.className = 'absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center';
                removeBtn.onclick = () => removeFile(index);
                previewWrapper.appendChild(removeBtn);

                previewContainer.appendChild(previewWrapper);

                if (index === files.length - 1) {
                    imagePreview.classList.remove('hidden');
                    conversionOptions.classList.remove('hidden');
                    convertBtn.classList.remove('hidden');
                }
            };
            reader.readAsDataURL(file);
        });
    }

    function removeFile(index) {
        selectedFiles.splice(index, 1);
        displayPreviews(selectedFiles);
        if (selectedFiles.length === 0) {
            imagePreview.classList.add('hidden');
            conversionOptions.classList.add('hidden');
            convertBtn.classList.add('hidden');
            downloadBtn.classList.add('hidden');
        }
    }

    // Format Selection Handling
    formatDropdownBtn.addEventListener('click', function() {
        formatDropdownContent.classList.toggle('hidden');
    });

    document.querySelectorAll('.format-option').forEach(option => {
        option.addEventListener('click', function () {
            selectedFormat = this.getAttribute('data-format');
            selectedFormatDisplay.textContent = this.textContent;
            document.querySelectorAll('.format-option').forEach(opt => opt.classList.remove('bg-gray-500'));
            this.classList.add('bg-gray-500');
            formatDropdownContent.classList.add('hidden');
        });
    });

    // Conversion Functions
    convertBtn.addEventListener('click', function () {
        if (selectedFiles.length > 0) {
            if (!isVerified) {
                showVerificationOverlay();
                return;
            }
            proceedWithConversion();
        } else {
            showError("Please select at least one image first.");
        }
    });

    async function proceedWithConversion() {
        showLoading();
        try {
            const convertedBlobs = await convertImages(selectedFiles, selectedFormat);
            hideLoading();
            showSuccessWithDownload(convertedBlobs, selectedFormat);
        } catch (error) {
            hideLoading();
            showError("Failed to convert images. Please try again.");
            console.error('Conversion error:', error);
        }
    }

    function convertImages(files, format) {
        return Promise.all(files.map(file => convertImage(file, format)));
    }

    function convertImage(file, format) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = function (e) {
                const img = new Image();
                img.onload = function () {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);

                    const mimeType = getMimeType(format);
                    if (!mimeType) {
                        reject(new Error('Unsupported format'));
                        return;
                    }

                    canvas.toBlob(blob => {
                        resolve(blob);
                    }, mimeType);
                };
                img.onerror = () => reject(new Error("Image load failed"));
                img.src = e.target.result;
            };
            reader.onerror = () => reject(new Error("File reading failed"));
            reader.readAsDataURL(file);
        });
    }

  function getMimeType(format) {
        const formatMap = {
            png: 'image/png',
            jpeg: 'image/jpeg',
            jpg: 'image/jpeg',
            webp: 'image/webp',
            gif: 'image/gif',
            bmp: 'image/bmp',
            tiff: 'image/tiff',
            ico: 'image/x-icon',
            svg: 'image/svg+xml',
            pdf: 'application/pdf',
            eps: 'application/postscript',
            heic: 'image/heic',
            jp2: 'image/jp2',
            psd: 'image/vnd.adobe.photoshop',
            raw: 'image/raw',
            tga: 'image/x-tga',
            hdr: 'image/vnd.radiance',
            exr: 'image/x-exr',
            dds: 'image/vnd.ms-dds',
            xcf: 'image/x-xcf',
            jxr: 'image/vnd.ms-photo',
        };
        return formatMap[format.toLowerCase()] || null;
    }

    // UI Feedback Functions
    function showSuccessWithDownload(blobs, format) {
        swal({
            title: "Success!",
            text: "Images converted successfully. Would you like to download them?",
            icon: "success",
            buttons: {
                cancel: "Cancel",
                download: {
                    text: "Download",
                    value: "download",
                },
            },
        })
        .then((value) => {
            if (value === "download") {
                downloadImages(blobs, format);
            }
        });
    }

    function downloadImages(blobs, format) {
        if (blobs.length === 1) {
            saveAs(blobs[0], `converted_image.${format}`);
        } else {
            const zip = new JSZip();
            blobs.forEach((blob, index) => {
                zip.file(`converted_image_${index + 1}.${format}`, blob);
            });
            zip.generateAsync({type: "blob"})
                .then(function(content) {
                    saveAs(content, "converted_images.zip");
                });
        }
    }

    function showLoading() {
        loadingOverlay.style.display = 'flex';
    }

    function hideLoading() {
        loadingOverlay.style.display = 'none';
    }

    function showError(message) {
        swal("Error", message, "error");
    }

    // Scroll to Top Functionality
    window.addEventListener('scroll', () => {
        if (window.pageYOffset > 100) {
            scrollTopBtn.classList.remove('opacity-0', 'invisible');
            scrollTopBtn.classList.add('opacity-100', 'visible');
        } else {
            scrollTopBtn.classList.add('opacity-0', 'invisible');
            scrollTopBtn.classList.remove('opacity-100', 'visible');
        }
    });

    scrollTopBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Initialize libraries
    AOS.init({
        duration: 1000,
        once: true
    });

    // Initialize Typed.js
    document.querySelectorAll('.typed-text').forEach(element => {
        new Typed(element, {
            strings: JSON.parse(element.getAttribute('data-typed')),
            typeSpeed: 50,
            backSpeed: 30,
            loop: true
        });
    });

    // FAQ Functionality
    document.querySelectorAll('.faq-item').forEach(item => {
        item.addEventListener('click', () => {
            item.classList.toggle('active');
            const answer = item.querySelector('.faq-answer');
            const icon = item.querySelector('.faq-icon');
            if (item.classList.contains('active')) {
                answer.style.maxHeight = answer.scrollHeight + "px";
                icon.style.transform = 'rotate(180deg)';
            } else {
                answer.style.maxHeight = null;
                icon.style.transform = 'rotate(0deg)';
            }
        });
    });
});
    </script>
</body>
</html>
